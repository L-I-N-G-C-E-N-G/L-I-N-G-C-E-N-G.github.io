<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>L1Nk8ug's Blog - 举旗高歌勇猛进，逆天逆命逆乾坤!</title><meta name="author" content="L-I-N-G-C-E-N-G"><meta name="copyright" content="L-I-N-G-C-E-N-G"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="举旗高歌勇猛进，逆天逆命逆乾坤!">
<meta property="og:type" content="website">
<meta property="og:title" content="L1Nk8ug&#39;s Blog">
<meta property="og:url" content="https://l-i-n-g-c-e-n-g.github.io/index.html">
<meta property="og:site_name" content="L1Nk8ug&#39;s Blog">
<meta property="og:description" content="举旗高歌勇猛进，逆天逆命逆乾坤!">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/11/29/XZwOGSrh8MabBTQ.png">
<meta property="article:author" content="L-I-N-G-C-E-N-G">
<meta property="article:tag" content="RedTeam 二进制安全 ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/11/29/XZwOGSrh8MabBTQ.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://l-i-n-g-c-e-n-g.github.io/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'L1Nk8ug\'s Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-12-14 11:11:23'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="E:\MyWeb\source\css\transpancy.css"><meta name="generator" content="Hexo 7.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2023/11/29/XZwOGSrh8MabBTQ.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> tools</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tool/"><i class="fa-fw fa fa-tags"></i><span> tool</span></a></li><li><a class="site-page child" href="/galgame/"><i class="fa-fw fa fa-archive"></i><span> galgame</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-images"></i><span> gallery</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/Friend/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/232957-16341389973a59.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="L1Nk8ug's Blog"><span class="site-name">L1Nk8ug's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> tools</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tool/"><i class="fa-fw fa fa-tags"></i><span> tool</span></a></li><li><a class="site-page child" href="/galgame/"><i class="fa-fw fa fa-archive"></i><span> galgame</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-images"></i><span> gallery</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/Friend/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">L1Nk8ug's Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/L-I-N-G-C-E-N-G" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lypu8pj.qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/12/14/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-2/" title="恶意代码分析12-2"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/220011-1623938411a765.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析12-2"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/14/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-2/" title="恶意代码分析12-2">恶意代码分析12-2</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-14T01:56:42.841Z" title="发表于 2023-12-14 09:56:42">2023-12-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/">恶意代码分析</a></span></div><div class="content">前置先收集一下PE看看 字符串也收集一下有多余的资源节 导出
加载指定的模块 先分析上面sub_40149D函数sub_40149D下的属性调用svchost.exe 跟进下函数GetSystemDirectoryA 开始检索svchost.exe 文件关键代码 sub_40132C 函数进行加载指定模块操作获取指定资源文件 findresourceA 下的name属性 LOCALIZATION  Type属性 UNICODE类型 并且为其开辟内存大小范围，在对其资源进行加密 sub_401000函数 并且保存到物理目录下，然后释放内存继续向下分析main 下判断的函数 sub_4010EA也可以看的出 前段0x5A4D 0x4550 验证PE文件的头 在检索svchost 。利用函数CreateProcessA挂起方式创建svchostReadProcessMemory 对 svchost 进行ebx +8 StackLimitGetProcAddress的 通过procname属性 “NtUnmapViewOfSection”卸载原本 stackWriteProcessMemory ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/12/05/hook_TLs%20(buuctf%20k00h_slT)/" title="hook_TLs (buuctf k00h_slT)"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/234913-16238585532b11.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="hook_TLs (buuctf k00h_slT)"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/05/hook_TLs%20(buuctf%20k00h_slT)/" title="hook_TLs (buuctf k00h_slT)">hook_TLs (buuctf k00h_slT)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-05T08:08:48.030Z" title="发表于 2023-12-05 16:08:48">2023-12-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CTF/">CTF</a></span></div><div class="content">WaitForSingleObject 利用函数让下一步出现阻塞状态  进入上一个函数所调用的属性StartAddress对其汇编定位 jnz jz 给 nop先把call 90 nop 走一下啊    40176E后到40177A的nop对下面数据也进行转汇编格式这所出现的 反复调用对齐 call 进行nop 40179C到4017A8  这边利用双字节一个一个90反编译 看样子是完整的分析wccmp    一个进程比较 继续往下 sub_401500 中的函数 sub_401170 base64 的加密开始没有思绪了这个东西好像不是很重要 我回到主main 看看  下面 rdata 表在入口处有没有钩把更近TLS看看 三个选项case 0  sub_401600()后就 break 了case 1  一个IsDebuggerPresent()反调试函数 不允许调试他case 2  TlsCallback_0 的汇编代码 不允许替换成 0x90 也就是 不允许自己函数被nop 会对其dword_4A7000 进行修改case 3 对其函数修改 不过调用的是之前分析到的base64也就 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/12/03/DASCTF%202023%E5%85%AD%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%EF%BD%9C%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%93%E9%A1%B9/" title="DASCTF 2023六月挑战赛｜二进制专项 WP"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/223621-1566570981fc22.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF 2023六月挑战赛｜二进制专项 WP"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/03/DASCTF%202023%E5%85%AD%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%EF%BD%9C%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%93%E9%A1%B9/" title="DASCTF 2023六月挑战赛｜二进制专项 WP">DASCTF 2023六月挑战赛｜二进制专项 WP</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-03T11:29:39.284Z" title="发表于 2023-12-03 19:29:39">2023-12-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CTF/">CTF</a></span></div><div class="content">careful看到 第一个 gethostbyname 下断进name 得到值 “welcome_t0_dasctf.com”第二个 gethostbyname name的值 “Just_An_APIH00k11.com”两种方法 
12345678910111213141516171819202122232425262728293031323334#include &lt;windows.h&gt;#include &lt;iostream&gt;int main(int argc, char** argv)&#123;    char name[] = &#123; &quot;welcome_t0_dasctf.com&quot; &#125;;    char* a1 = name;    name[0] = *a1 ^ 0x3D;    name[1] = a1[1] ^ 0x10;    name[2] = a1[2] ^ 0x1F;    name[3] = a1[3] ^ 0x17;    name[4] = a1[4] ^ 0x30;    name[5] = a1[ ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/12/02/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-1/" title="恶意代码分析12-1"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/234718-15895576386a47.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析12-1"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/02/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-1/" title="恶意代码分析12-1">恶意代码分析12-1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-02T11:06:33.758Z" title="发表于 2023-12-02 19:06:33">2023-12-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/">恶意代码分析</a></span></div><div class="content">前言
不动态分析 静态问题利用strings 把 EXE  和 DLL 数据信息采集起来
可以看到exe 的一连几个函数 特别连续CloseHandle  关闭打开的对象句柄  ？？whoOpenProcess  打开现有的本地进程对象CreateRemoteThread 创建在另一个进程的地址空间中运行的线程GetModuleHandleA  加载模块 此模块也必须由进程调用WriteProcessMemory  将数据写入到指定进程中的内存区域 且整个区域可以访问 或者失败VirtualAllocEx  在指定进程的虚拟地址空间中保留、提交或更改内存区域的状态。lstrcatA  开始追加这样一看真像dll 进程注入  后面还有一些 kernel32.dll Lab12-01.dll psapi.dll explorer.exe可能是恶意代码注入的目标
这个恶意代码样本是如何工作的？哪个进程会被注入? ?丢 IDA 分析跟进第一步 查查第一个函数下的调用 看到是这边会调用 psapi.dll 模块 获取进程信息   并且检索dll导出函数以及变量地址下面的一些系统API 函数基本是 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/12/01/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-2/" title="恶意代码分析11-2"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/205419-1613480059a058.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析11-2"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/01/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-2/" title="恶意代码分析11-2">恶意代码分析11-2</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-01T07:15:38.965Z" title="发表于 2023-12-01 15:15:38">2023-12-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/">恶意代码分析</a></span></div><div class="content">一.前置做一些字符的收集 strings.exe .\Lab11-02.dll这边也可以知道  dll利用 AppInit_DLLs 实现挂钩安装并且关联注册表SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windowsstrings.exe .\Lab11-02.ini  看样子是个加密值 或者是 钥匙
1.这个恶意的DLL 导出了什么静态分析 第一个函数 GetModuleFileNameA  检索模块并且加载当前进程看到调用偏移量是 Installer +76往下跟进入 到了installer() 函数里 知识点 是 rundll32.exe 模块 来启动 此dll也就是说这边导出的是 installer  启动命令是  rundll32.exe  Lab11-02.dll,installer使用静态分析就不做动调 
2.使用rundll32.exe 安装这个恶意代码后，发生了什么？恶意代码的驻留？在刚才跟进 偏移位是+76 更进函数是 CopyFileA() 函数中的属性安装后会把文件拷贝在系统目录运行后根据上面注册表的自信会是SOF ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/12/01/NewStarCTF%20WP%20WEEK4_%20reverse/" title="NewStarCTF WP WEEK4 _ reverse"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/000047-1586620847dbc8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NewStarCTF WP WEEK4 _ reverse"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/01/NewStarCTF%20WP%20WEEK4_%20reverse/" title="NewStarCTF WP WEEK4 _ reverse">NewStarCTF WP WEEK4 _ reverse</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-01T07:15:12.748Z" title="发表于 2023-12-01 15:15:12">2023-12-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CTF/">CTF</a></span></div><div class="content">茶这题目主要是思路是字节码 MV 我们开始动调 主要目标进入 MV 做对齐 ，TEA对其关键代码进行分析跟进VM分析  一共是case 5次  长度为40 opencode 静态也找不到需要的 我们进行动调 在vm出断点 f9 f7 进入 call 跳转 进入 vm public更近他们 var_10  栈 列表 一步一步对其我们需要从下往上写 堆栈的原理的 先入栈的会在栈底
12345678910111213141516171819202122232425262728		0xF1[0,0,2]                                0xF1[1,1,2]                                0xF1[3,0,0]                        	0xF1[2,0,0]                                0xF2[3,0x9e3779b9,0]                                0xF1[4,1,1]                        	0xF5[4,5 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/12/01/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-1/" title="恶意代码分析11-1"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/230242-16002685626a1d.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析11-1"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/01/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-1/" title="恶意代码分析11-1">恶意代码分析11-1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-01T03:22:40.344Z" title="发表于 2023-12-01 11:22:40">2023-12-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/">恶意代码分析</a></span></div><div class="content">PE识别 x32位的文件  先找main 函数在说  winmain main maindll 这些的需要的 恶意代码分析主要还是经验以及知识点 Windows平台的了解 还有对PE文件的了解 
Q1.这个恶意代码向磁盘释放了什么?开始分析 先载了 CFF Explorer 32位 继续往下 先查询段头部地址 存在PE 头和 MZ 头地址 继续看看 好家伙两个文件 （一开始我做题目犯了除 CTF做多了一般是直接丢IDA ）继续把下面包含的文件导出先在得到一个7K的文件现在开用ida分析exeida开始更近main 解释一下这两个函数GetModuleHandleA（）检索模块创建进程 也就说这里会有东西被调用GetModuleFileNameA() 加载进程完 查找另一个 模块文件加载  （dll 7k？？？）跟入第一个函数 sub_401080  4个函数 还有文件操作查看fopen 函数的所打开的文件是谁FindResourceA() 确定指定模块中具有指定类型和名称的资源的位置 进路函数下面的区块 lpNAMELoadResource()  加载模块中的ID 和字符串LockRe ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/12/01/NewStarCTF%20WP%20WEEK2_%20reverse/" title="NewStarCTF WP WEEK2 _ reverse"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/194423-1613475863c1a0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NewStarCTF WP WEEK2 _ reverse"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/01/NewStarCTF%20WP%20WEEK2_%20reverse/" title="NewStarCTF WP WEEK2 _ reverse">NewStarCTF WP WEEK2 _ reverse</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-01T02:22:41.437Z" title="发表于 2023-12-01 10:22:41">2023-12-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CTF/">CTF</a></span></div><div class="content">androgenshin
元神启动主函数 找找一个 rc 一个base64
解rc4
12345678910111213141516171819202122232425262728293031#include&lt;bits/stdc++.h&gt;using namespace std;signed main()&#123;	int base64_table[] = &#123;125, 239, 101, 151, 77, 163, 163, 110, 58, 230, 186, 206, 84, 84, 189, 193, 30, 63, 104, 178, 130, 211, 164, 94, 75, 16, 32, 33, 193, 160, 120, 47, 30, 127, 157, 66, 163, 181, 177, 47, 0, 236, 106, 107, 144, 231, 111, 16, 36, 34, 91, 9, 188, 81, 5, 241, 235, 3, 54, 150, 40, 119, 202, 150&#125;;	string key = ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/11/30/NewStarCTF%20WP%20WEEK3_%20reverse/" title="NewStarCTF WP WEEK3 _ reverse"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/000008-1572019208ea18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NewStarCTF WP WEEK3 _ reverse"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/11/30/NewStarCTF%20WP%20WEEK3_%20reverse/" title="NewStarCTF WP WEEK3 _ reverse">NewStarCTF WP WEEK3 _ reverse</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-11-30T06:26:54.324Z" title="发表于 2023-11-30 14:26:54">2023-11-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CTF/">CTF</a></span></div><div class="content">花ida 丢进去 脱花 跟下 RC4判断一下  密钥 一串wowo….. 
12345678910111213141516171819202122232425262728293031323334#include&lt;bits/stdc++.h&gt;using namespace std;nsigned mian()&#123;    int base64_table[] = &#123;0xF4, 0x87, 0xD4, 0xFA, 0x61, 0xA6, 0x71, 0x12, 0x75, 0x09,   0xFE, 0xD8, 0xE4, 0x38, 0x97, 0x51, 0xA8, 0xDF, 0x85, 0x65,   0xC2, 0xB2, 0x15, 0xEF, 0x1F, 0xEC, 0x69, 0xDD, 0x6E, 0xE9,   0xCF, 0x07, 0xAE, 0xC8, 0x17, 0xF0, 0x65, 0x72, 0xE6, 0x73,   0xA4, 0x0C, 0x87, 0x64, 0x9E, 0x9E, 0x71, 0x8C, 0x7F, 0 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/11/29/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-3/" title="恶意代码分析11-3"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/000005-1611158405c3d5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析11-3"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/11/29/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-3/" title="恶意代码分析11-3">恶意代码分析11-3</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-11-29T10:54:41.417Z" title="发表于 2023-11-29 18:54:41">2023-11-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/">恶意代码分析</a></span></div><div class="content">恶意代码分析11 -3
使用基础静态分析过程，你可以发现什么有趣的线索？
leb11-03.exe 如何安装leb11-03.dll 使其长期驻留？
恶意代码感染了Windows的那个文件？ led11-03.dll做了什么？这个恶意代码将收集的信息存放在何处？
当运行这个代码的时，发生了什么？

1.使用基础静态分析过程，你可以发现什么有趣的线索？对exe进行字符串的收集cisvc.exe 内存检测会被修改 inet_epar32.dll 出现的两次让其觉的是复制该文件dll字符串分析看样子有对键盘记录的函数 调用user32.dll的函数不在少数 还有记录时间微软：getAsyncKeyState 函数 (winuser.h) - Win32 apps | Microsoft LearnC:\WINDOWS\System32\inet_epar32.dllC:\WINDOWS\System32%scisvc.exenet start cisvc 启动服务命令
2.leb11-03.exe 如何安装leb11-03.dll 使其长期驻留？主函数第一步就是复制文件进行改名目录下存在此文 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2023/11/29/XZwOGSrh8MabBTQ.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">L-I-N-G-C-E-N-G</div><div class="author-info__description">举旗高歌勇猛进，逆天逆命逆乾坤!</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/L-I-N-G-C-E-N-G"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/L-I-N-G-C-E-N-G" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lypu8pj.qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/12/14/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-2/" title="恶意代码分析12-2"><img src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/220011-1623938411a765.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析12-2"/></a><div class="content"><a class="title" href="/2023/12/14/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-2/" title="恶意代码分析12-2">恶意代码分析12-2</a><time datetime="2023-12-14T01:56:42.841Z" title="发表于 2023-12-14 09:56:42">2023-12-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/05/hook_TLs%20(buuctf%20k00h_slT)/" title="hook_TLs (buuctf k00h_slT)"><img src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/234913-16238585532b11.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="hook_TLs (buuctf k00h_slT)"/></a><div class="content"><a class="title" href="/2023/12/05/hook_TLs%20(buuctf%20k00h_slT)/" title="hook_TLs (buuctf k00h_slT)">hook_TLs (buuctf k00h_slT)</a><time datetime="2023-12-05T08:08:48.030Z" title="发表于 2023-12-05 16:08:48">2023-12-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/03/DASCTF%202023%E5%85%AD%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%EF%BD%9C%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%93%E9%A1%B9/" title="DASCTF 2023六月挑战赛｜二进制专项 WP"><img src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/223621-1566570981fc22.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF 2023六月挑战赛｜二进制专项 WP"/></a><div class="content"><a class="title" href="/2023/12/03/DASCTF%202023%E5%85%AD%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%EF%BD%9C%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%93%E9%A1%B9/" title="DASCTF 2023六月挑战赛｜二进制专项 WP">DASCTF 2023六月挑战赛｜二进制专项 WP</a><time datetime="2023-12-03T11:29:39.284Z" title="发表于 2023-12-03 19:29:39">2023-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/02/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-1/" title="恶意代码分析12-1"><img src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/234718-15895576386a47.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析12-1"/></a><div class="content"><a class="title" href="/2023/12/02/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2012%20-1/" title="恶意代码分析12-1">恶意代码分析12-1</a><time datetime="2023-12-02T11:06:33.758Z" title="发表于 2023-12-02 19:06:33">2023-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/01/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-2/" title="恶意代码分析11-2"><img src="https://cdn.jsdelivr.net/gh/L-I-N-G-C-E-N-G/IMG_SSSS@1.0/205419-1613480059a058.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="恶意代码分析11-2"/></a><div class="content"><a class="title" href="/2023/12/01/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%2011%20-2/" title="恶意代码分析11-2">恶意代码分析11-2</a><time datetime="2023-12-01T07:15:38.965Z" title="发表于 2023-12-01 15:15:38">2023-12-01</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CTF/"><span class="card-category-list-name">CTF</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/"><span class="card-category-list-name">恶意代码分析</span><span class="card-category-list-count">5</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E4%BD%9C%E4%B8%BA%E8%AE%B0%E5%BD%95%E5%8A%A0%E5%AF%86/" style="font-size: 1.1em; color: #999">作为记录加密</a> <a href="/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 1.5em; color: #99a9bf">恶意代码分析</a> <a href="/tags/CTF/" style="font-size: 1.5em; color: #99a9bf">CTF</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><span class="card-archive-list-count">3</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">11</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-12-14T03:11:23.387Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2023  BY L-I-N-G-C-E-N-G - 2023 By L-I-N-G-C-E-N-G</div><div class="footer_custom_text"><meta name="msvalidate.01" content="3E8202CC197C12846FFB8AE868C09F2D" /></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["因为困难多壮志，不教红尘惑坚心！今身暂且栖草头，他日狂歌踏山河！踏青山，蹈南海，缚苍龙，击长空！笑看沧海千万事，策算天下定乾坤！沐风雨，磨魂魄，崩山石，破情志！举旗高歌勇猛进，逆天逆命逆乾坤！"])
  } else {
    document.getElementById("subtitle").textContent = "因为困难多壮志，不教红尘惑坚心！今身暂且栖草头，他日狂歌踏山河！踏青山，蹈南海，缚苍龙，击长空！笑看沧海千万事，策算天下定乾坤！沐风雨，磨魂魄，崩山石，破情志！举旗高歌勇猛进，逆天逆命逆乾坤！"
  }
}
typedJSFn.run(subtitleType)</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>